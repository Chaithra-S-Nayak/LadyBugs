# For reference: https://docs.devrev.ai/snap-ins/references/manifest.
# Refactor the code based on your business logic.

version: "2"
name: "Work Tracker"
description: "Logs a message when a work item is created"

# This is the name displayed in DevRev where the Snap-In takes actions using the token of this service account.
service_account:
  display_name: DevRev Bot

# Add any external connection, reference: https://docs.devrev.ai/snap-ins/concepts#connection.

# Add organization level inputs, reference: https://docs.devrev.ai/snap-ins/references/inputs.
inputs:
  organization:
    - name: sample_value
      description: Sample input value.
      field_type: text
      default_value: "primary"
      ui:
        display_name: Sample Value

# Event source reference: https://docs.devrev.ai/snap-ins/references/event_sources#supported-event-source-types-and-their-event-types.
event_sources:
  organization:
    - name: devrev-webhook
      description: Event coming from DevRev
      display_name: Devrev
      type: devrev-webhook
      config:
        event_types:
          - work_updated

# Functions reference: https://docs.devrev.ai/snap-ins/references/functions.
functions:
  - name: generate_report
    description: function to trigger on /report command
  - name: show_popup_message
    description: Show a success message in the DevRev UI

commands:
  - name: report
    namespace: devrev
    description: Create a summary report of opportunities with charts.
    surfaces:
      - surface: discussions
        object_types:
          - opportunity
    usage_hint: "[timeframe] [slack_channel] [chart_color]"
    function: generate_report

snap_kit_actions:
  - name: show_success_popup
    description: Show a success message in the DevRev UI
    function: show_popup_message
